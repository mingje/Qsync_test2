
<html>
   <head>
      <style type="text/css">
         .sikuli-code {
            font-size: 20px;
            font-family: "Osaka-mono", Monospace;
            line-height: 1.5em;
            display:table-cell;
            white-space: pre-wrap;       /* css-3 */
            white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
            white-space: -pre-wrap;      /* Opera 4-6 */
            white-space: -o-pre-wrap;    /* Opera 7 */
            word-wrap: break-word;       /* Internet Explorer 5.5+ */
            width: 99%;   /* remove horizontal scroll-bar when viewing in IE7 */
         }
         .sikuli-code img {
            vertical-align: middle;
            margin: 2px;
            border: 1px solid #ccc;
            padding: 2px;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            -moz-box-shadow: 1px 1px 1px gray;
            -webkit-box-shadow: 1px 1px 2px gray;
         }
         .kw {
            color: blue;
         }
         .skw {
            color: rgb(63, 127, 127);
         }

         .str {
            color: rgb(128, 0, 0);
         }

         .dig {
            color: rgb(128, 64, 0);
         }

         .cmt {
            color: rgb(200, 0, 200);
         }

         h2 {
            display: inline;
            font-weight: normal;
         }

         .info {
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 20px;
            display: none;
         }

         a {
            color: #9D2900;
         }

         body {
            font-family: "Trebuchet MS", Arial, Sans-Serif;
         }

      </style>
   </head>
<body>
<div class="info">
<h2>library_qsync.sikuli</h2> <a href="library_qsync.zip">(Download this script)</a>
</div>
<pre class="sikuli-code">
<span class="cmt"># -*- coding:utf-8 -*-</span>
<span class="kw">from</span> sikuli <span class="kw">import</span> *
<span class="kw">import</span> os
<span class="kw">import</span> sys
<span class="kw">import</span> random
<span class="kw">import</span> time
<span class="kw">import</span> smtplib
<span class="kw">from</span> email.mime.multipart <span class="kw">import</span> MIMEMultipart
<span class="kw">from</span> email.mime.text <span class="kw">import</span> MIMEText
<span class="kw">from</span> email.mime.application <span class="kw">import</span> MIMEApplication

<span class="cmt">################# Testing Info ###################</span>
AT_VM_S2 = {
    <span class="str">"ip"</span>: <span class="str">"10.20.241.134"</span>,
    <span class="str">"folder_name"</span>: <span class="str">"share_test_desktop-kp8ovfb"</span>,
    <span class="str">"pc_name"</span>: <span class="str">"desktop-kp8ovfb"</span>,
    <span class="str">"ac"</span>: <span class="str">"dqv"</span>,
    <span class="str">"pwd"</span>: <span class="str">"swqa"</span>
        }
AT_PC_S1 = {
    <span class="str">"ip"</span>: <span class="str">"10.20.241.131"</span>,
    <span class="str">"folder_name"</span>: <span class="str">"share_test_desktop-11ih26e"</span>,
    <span class="str">"pc_name"</span>: <span class="str">"desktop-11ih26e"</span>,
    <span class="str">"ac"</span>: <span class="str">"dqv"</span>,
    <span class="str">"pwd"</span>: <span class="str">"swqa"</span>
        }
AT_PC_S2 = {
    <span class="str">"ip"</span>: <span class="str">"10.20.241.132"</span>,
    <span class="str">"folder_name"</span>: <span class="str">"share_test_desktop-u1af6o9"</span>,
    <span class="str">"pc_name"</span>: <span class="str">"desktop-u1af6o9"</span>,
    <span class="str">"ac"</span>: <span class="str">"Utility_test"</span>,
    <span class="str">"pwd"</span>: <span class="str">"swqa"</span>
        }
AT_PC_S3 = {
    <span class="str">"ip"</span>: <span class="str">"10.20.241.138"</span>,
    <span class="str">"folder_name"</span>: <span class="str">"share_test_erincheng-pc"</span>,
    <span class="str">"pc_name"</span>: <span class="str">"erincheng-pc"</span>,
    <span class="str">"ac"</span>: <span class="str">"dqv"</span>,
    <span class="str">"pwd"</span>: <span class="str">"swqa"</span>
        }
AT_VM_S3 = {
    <span class="str">"ip"</span>: <span class="str">"10.20.241.133"</span>,
    <span class="str">"folder_name"</span>: <span class="str">"share_test_dqv-pc1"</span>,
    <span class="str">"pc_name"</span>: <span class="str">"dqv-pc1"</span>,
    <span class="str">"ac"</span>: <span class="str">"dqv1"</span>,
    <span class="str">"pwd"</span>: <span class="str">"swqa"</span>
        }
AT_VM_S1 = {
    <span class="str">"ip"</span>: <span class="str">"10.20.241.135"</span>,
    <span class="str">"folder_name"</span>: <span class="str">"share_test_desktop-d3ogd7m"</span>,
    <span class="str">"pc_name"</span>: <span class="str">"desktop-d3ogd7m"</span>,
    <span class="str">"ac"</span>: <span class="str">"dqv"</span>,
    <span class="str">"pwd"</span>: <span class="str">"swqa"</span>
        }
AT_list = [AT_VM_S2, AT_VM_S3, AT_PC_S2]

Mon = {
    <span class="str">"mark"</span>: <span class="str">"Mon"</span>,
    <span class="str">"share_file"</span>: <span class="dig">1903</span>,
    <span class="str">"share_folder"</span>: <span class="dig">614</span>,
    <span class="str">"share_size"</span>: <span class="dig">1143524890</span>,
    <span class="str">"team_file"</span>: <span class="dig">1903</span>,
    <span class="str">"team_folder"</span>: <span class="dig">614</span>,
    <span class="str">"team_size"</span>: <span class="dig">1143524890</span>
        }
Tue = {
    <span class="str">"mark"</span>: <span class="str">"Tue"</span>,
    <span class="str">"share_file"</span>: <span class="dig">1903</span>,
    <span class="str">"share_folder"</span>: <span class="dig">614</span>,
    <span class="str">"share_size"</span>: <span class="dig">1143524890</span>,
    <span class="str">"team_file"</span>: <span class="dig">1903</span>,
    <span class="str">"team_folder"</span>: <span class="dig">614</span>,
    <span class="str">"team_size"</span>: <span class="dig">1143524890</span>
        }
Wed = {
    <span class="str">"mark"</span>: <span class="str">"Wed"</span>,
    <span class="str">"share_file"</span>: <span class="dig">1903</span>,
    <span class="str">"share_folder"</span>: <span class="dig">614</span>,
    <span class="str">"share_size"</span>: <span class="dig">1143524890</span>,
    <span class="str">"team_file"</span>: <span class="dig">1903</span>,
    <span class="str">"team_folder"</span>: <span class="dig">614</span>,
    <span class="str">"team_size"</span>: <span class="dig">1143524890</span>
        }
Thu = {
    <span class="str">"mark"</span>: <span class="str">"Thu"</span>,
    <span class="str">"share_file"</span>: <span class="dig">1903</span>,
    <span class="str">"share_folder"</span>: <span class="dig">614</span>,
    <span class="str">"share_size"</span>: <span class="dig">1143524890</span>,
    <span class="str">"team_file"</span>: <span class="dig">1903</span>,
    <span class="str">"team_folder"</span>: <span class="dig">614</span>,
    <span class="str">"team_size"</span>: <span class="dig">1143524890</span>
        }
Fri = {
    <span class="str">"mark"</span>: <span class="str">"Fri"</span>,
    <span class="str">"share_file"</span>: <span class="dig">1903</span>,
    <span class="str">"share_folder"</span>: <span class="dig">614</span>,
    <span class="str">"share_size"</span>: <span class="dig">1143524890</span>,
    <span class="str">"team_file"</span>: <span class="dig">1903</span>,
    <span class="str">"team_folder"</span>: <span class="dig">614</span>,
    <span class="str">"team_size"</span>: <span class="dig">1143524890</span>
        }
Sat = {
    <span class="str">"mark"</span>: <span class="str">"Sat"</span>,
    <span class="str">"share_file"</span>: <span class="dig">0</span>,
    <span class="str">"share_folder"</span>: <span class="dig">2</span>,
    <span class="str">"share_size"</span>: <span class="dig">0</span>,
    <span class="str">"team_file"</span>: <span class="dig">0</span>,
    <span class="str">"team_folder"</span>: <span class="dig">2</span>,
    <span class="str">"team_size"</span>: <span class="dig">0</span>
        }
Sun =  {
    <span class="str">"mark"</span>: <span class="str">"Sun"</span>,
    <span class="str">"share_file"</span>: <span class="dig">0</span>,
    <span class="str">"share_folder"</span>: <span class="dig">2</span>,
    <span class="str">"share_size"</span>: <span class="dig">0</span>,
    <span class="str">"team_file"</span>: <span class="dig">0</span>,
    <span class="str">"team_folder"</span>: <span class="dig">2</span>,
    <span class="str">"team_size"</span>: <span class="dig">0</span>
        }
week_list = [Mon, Tue, Wed, Thu, Fri, Sat, Sun]

sys_path = sys.path[<span class="dig">0</span>]
sys_path_split = sys_path.split(<span class="str">"\\"</span>)
<span class="kw">del</span> sys_path_split[-<span class="dig">1</span>]
<span class="kw">print</span>(sys_path_split)
delimiter = <span class="str">"\\"</span>
picture_path = delimiter.join(sys_path_split) + <span class="str">"\\screenshot\\"</span>
<span class="kw">print</span>(picture_path)

<span class="kw">def</span> nas_detail(**kwargs):
    nas = {}
    nas[<span class="str">"lanip"</span>] = kwargs.get(<span class="str">"lanip"</span>)
    nas[<span class="str">"ac"</span>] = kwargs.get(<span class="str">"ac"</span>)
    nas[<span class="str">"pwd"</span>] = kwargs.get(<span class="str">"pwd"</span>)
    <span class="kw">return</span> nas

<span class="kw">def</span> search_path(picture_name):
    check_path = picture_path + picture_name + <span class="str">"\\"</span>
    <span class="kw">print</span>(check_path)
    search_list = os.listdir(check_path)
    <span class="kw">print</span>(search_list)
    <span class="kw">for</span> i <span class="kw">in</span> search_list:
        <span class="kw">print</span>(i)
        final_path = check_path + i
        <span class="kw">print</span>(final_path)
        <span class="kw">if</span> exists(final_path):
            <span class="kw">print</span>(<span class="str">"Found picture"</span>)
            flag = final_path
            <span class="kw">break</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Not Found picture"</span>)
            flag = final_path
    <span class="kw">return</span> flag

<span class="kw">def</span> target_week():
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    now_week = week_current()
    <span class="kw">print</span>(now_week)
    <span class="kw">for</span> i <span class="kw">in</span> week_list:
        <span class="kw">if</span> i[<span class="str">"mark"</span>] == now_week:
            <span class="kw">return</span> i
            <span class="kw">break</span>
        <span class="kw">else</span>:
            <span class="kw">pass</span>


<span class="cmt">################# System related function ###################</span>
<span class="kw">def</span> get_os_bit():
    os_bit = os.popen(<span class="str">"echo %PROCESSOR_ARCHITECTURE%"</span>).read()
    <span class="kw">if</span> <span class="str">"64"</span> <span class="kw">in</span> os_bit:
        os_bit = <span class="str">"64"</span>
    <span class="kw">else</span>:
        os_bit = <span class="str">"32"</span>
    <span class="kw">return</span> os_bit

<span class="cmt"># get_pc_info(info_name = "pc_name" or "user_name")</span>
<span class="kw">def</span> get_pc_info(info_name):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    info_name_list = []
    pc_info = os.popen(<span class="str">"whoami"</span>).read()
    pc_info_list = pc_info.split(<span class="str">"\\"</span>)
    pc_name = pc_info_list[<span class="dig">0</span>]
    user_name = pc_info_list[<span class="dig">1</span>]
    user_name = user_name[<span class="dig">0</span>:-<span class="dig">1</span>]
    <span class="kw">if</span> info_name == <span class="str">"pc_name"</span>:
        <span class="kw">return</span> pc_name
    <span class="kw">else</span>:
        <span class="kw">return</span> user_name

<span class="kw">def</span> get_os_ver():
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    os_dir = os.popen(<span class="str">"ver"</span>).read()
    os_split = os_dir.split(<span class="str">"["</span>)
    os_split1 = os_split[<span class="dig">1</span>].split(<span class="str">" "</span>)
    os_split2 = os_split1[<span class="dig">1</span>].split(<span class="str">"."</span>)
    <span class="kw">if</span> os_split2[<span class="dig">0</span>] == <span class="str">"10"</span>:
        <span class="kw">print</span>(<span class="str">"OS is Win10"</span>)
        <span class="kw">return</span> <span class="str">"Win10"</span>
    <span class="kw">elif</span> os_split2[<span class="dig">0</span>] == <span class="str">"6"</span>:
        <span class="kw">print</span>(<span class="str">"OS is Win7"</span>)
        <span class="kw">return</span> <span class="str">"Win7"</span>
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Unknown OS"</span>)
        <span class="kw">return</span> <span class="str">"Unknown OS"</span>

<span class="kw">def</span> week_current():
    localtime = time.asctime( time.localtime(time.time()) )
    <span class="kw">print</span> <span class="str">"Locatime:"</span>, localtime
    localtime_space = localtime.split(<span class="str">" "</span>)
    week_current = localtime_space[<span class="dig">0</span>]
    <span class="kw">return</span> week_current

<span class="kw">def</span> mount_disk(ip, folder_name, username, password, disk):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    mount_cmd = <span class="str">"net use "</span> + disk + <span class="str">": "</span> + <span class="str">"\\\\"</span> + ip + <span class="str">"\\"</span> + folder_name + <span class="str">" /user:"</span> + username + <span class="str">" "</span> + password
    <span class="kw">print</span>(mount_cmd)
    os.system(mount_cmd)
    dir_cmd = <span class="str">"dir "</span> + disk + <span class="str">":\\"</span>
    flag = os.system(dir_cmd)
    <span class="kw">if</span> flag == <span class="dig">0</span>:
        <span class="kw">print</span>(<span class="str">"Mount success"</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Mount failed"</span>)
    <span class="cmt"># assert flag == 0, "Mount failed"</span>
    <span class="skw">wait</span>(<span class="dig">1</span>)

<span class="kw">def</span> unmount_disk(disk):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    os.system(<span class="str">"net use * /d /YES"</span>)
    dir_cmd = <span class="str">"dir "</span> + disk + <span class="str">":\\"</span>
    flag = os.system(dir_cmd)
    <span class="kw">if</span> flag == <span class="dig">1</span>:
        <span class="kw">print</span>(<span class="str">"Unmount success"</span>)
    <span class="kw">else</span>:
        <span class="kw">pass</span>
    <span class="kw">assert</span> flag == <span class="dig">1</span>, <span class="str">"Unmount failed"</span>
    <span class="skw">wait</span>(<span class="dig">1</span>)

<span class="cmt"># clean_remote_disk("w")</span>
<span class="kw">def</span> clean_remote_disk(disk):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    clean_cmd = <span class="str">"rd /s/q "</span> + disk + <span class="str">":\\"</span>
    <span class="kw">try</span>:
        os.system(clean_cmd)
    <span class="kw">except</span>:
        <span class="kw">pass</span>
    path = disk + <span class="str">":\\"</span>
    <span class="kw">if</span> counter_data(<span class="str">"icon_total"</span>, <span class="str">"single"</span>, path) == <span class="dig">0</span>:
        <span class="kw">print</span>(<span class="str">"clean success"</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"clean failed"</span>)

<span class="kw">def</span> run_path():
    source_path =sys.path[<span class="dig">0</span>]
    path_spl = source_path.split(<span class="str">"\\"</span>)
    <span class="kw">del</span> path_spl[-<span class="dig">1</span>]
    out_path = <span class="str">"\\"</span>.join(path_spl)
    <span class="kw">return</span> out_path

<span class="cmt"># delete_folder("D:\\test\\")</span>
<span class="kw">def</span> delete_folder(path):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    cmd = run_path() + <span class="str">"\\delete.bat "</span> + path
    <span class="kw">print</span>(cmd)
    os.system(cmd)
    <span class="kw">if</span> counter_data(<span class="str">"icon_total"</span>, <span class="str">"single"</span>, path) == <span class="dig">0</span>:
        <span class="kw">print</span>(<span class="str">"Clean success"</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Clean failed"</span>)

<span class="kw">def</span> send_mail(test_pc):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    gmail_user = <span class="str">'stevenhsu@qnap.com'</span>
    gmail_password = <span class="str">'Poiu)98765'</span> <span class="cmt"># your gmail password</span>
    gmail_to = [<span class="str">'mingje1104@gmail.com'</span>]
    gmail_cc = [<span class="str">'stevenhsu@qnap.com'</span>]
    COMMASPACE = <span class="str">', '</span>
    <span class="cmt">#msg = MIMEText('content')</span>
    msg = MIMEMultipart()
    msg[<span class="str">'Subject'</span>] = <span class="str">'ERROR'</span>
    msg[<span class="str">'From'</span>] = <span class="str">"AT manager"</span>
    msg[<span class="str">'To'</span>] = COMMASPACE.join(gmail_to)
    msg[<span class="str">'cc'</span>] = COMMASPACE.join(gmail_cc)
    error_code = <span class="str">"\n0: Check main sync UI Fail \n1: Checksum check FAIL \n"</span> + <span class="str">"2: Data files, folders and size not match \n"</span> \
        + <span class="str">"3: Root folder icon check FAIL \n4: Advanced folder icon check FAIL"</span>
    part = MIMEText(test_pc + error_code)
    msg.attach(part)

    server = smtplib.SMTP_SSL(<span class="str">'smtp.gmail.com'</span>, <span class="dig">465</span>)
    server.ehlo()
    server.login(gmail_user, gmail_password)
    server.sendmail(gmail_user,gmail_to,msg.as_string())
    server.quit()
    <span class="kw">print</span>(<span class="str">'Email sent!'</span>)

<span class="kw">def</span> wait_time(loop, waittime):
    x = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> range(loop):
        <span class="kw">if</span> x == <span class="dig">0</span>:
            <span class="kw">print</span>(<span class="str">"start to wait"</span>)
        <span class="kw">else</span>:
            <span class="kw">pass</span>
        <span class="skw">wait</span>(waittime)
        <span class="kw">print</span>(<span class="str">"Pass "</span> + str(waittime) + <span class="str">" secs"</span>)
        x = x + <span class="dig">1</span>

<span class="kw">def</span> exist_check(file):
    cmd = <span class="str">"IF EXIST "</span> + file + <span class="str">" (ECHO True) ELSE (ECHO False)"</span>
    echo = os.popen(cmd).read()
    echo_result = echo.split(<span class="str">"\n"</span>)
    <span class="kw">return</span> echo_result[<span class="dig">0</span>]


<span class="cmt">################# Windows behavior function ###################</span>
<span class="cmt"># open folder with win browser (open_folder("D:\\test"))</span>
<span class="kw">def</span> open_folder(folder_path):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="kw">for</span> j <span class="kw">in</span> range(<span class="dig">3</span>):
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(<span class="str">"r"</span>, KeyModifier.WIN)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="kw">if</span> folder_path == <span class="str">"default"</span>:
            path = <span class="str">"C:\\Users\\"</span> + get_pc_info(<span class="str">"user_name"</span>) + <span class="str">"\\Qsync\\"</span>
        <span class="kw">else</span>:
            path = folder_path
        <span class="kw">print</span>(path)
        paste(unicode(path, <span class="str">"utf8"</span>))
        <span class="kw">print</span>(<span class="str">"paste path"</span>)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(Key.TAB)
        <span class="skw">wait</span>(<span class="dig">3</span>)
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"confirm_button"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="kw">break</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"paste fail, redo"</span>)
            <span class="skw">type</span>(Key.F4, KeyModifier.ALT)

    <span class="cmt"># type(path)</span>
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="skw">type</span>(Key.UP, KeyModifier.WIN)

<span class="kw">def</span> open_folder_cmd(folder_path, os_ver):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="kw">for</span> i <span class="kw">in</span> range(<span class="dig">3</span>):
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="kw">if</span> folder_path == <span class="str">"default"</span>:
            path = <span class="str">"C:\\Users\\"</span> + get_pc_info(<span class="str">"user_name"</span>) + <span class="str">"\\Qsync\\"</span>
        <span class="kw">else</span>:
            path = folder_path
        <span class="kw">print</span>(path)
        cmd = <span class="str">"explorer "</span> + path
        os.system(cmd)
        <span class="skw">wait</span>(<span class="dig">3</span>)
        <span class="kw">if</span> check_open_folder(os_ver) == <span class="dig">1</span>:
            <span class="kw">print</span>(<span class="str">"Open folder success"</span>)
            <span class="kw">break</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Open folder fail"</span>)
    <span class="kw">if</span> check_max_window(os_ver) == <span class="dig">1</span>:
        <span class="kw">print</span>(<span class="str">"Max window success"</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Max windows fail"</span>)
    <span class="skw">wait</span>(<span class="dig">1</span>)

<span class="kw">def</span> set_browser_sty(os_ver):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="kw">if</span> os_ver == <span class="str">"Win10"</span>:

        check_region = Region(<span class="dig">59</span>,<span class="dig">7</span>,<span class="dig">273</span>,<span class="dig">44</span>)

        check_region.<span class="skw">click</span>(Pattern(search_path(<span class="str">"view_tab"</span>)).similar(<span class="dig">0.70</span>))
        <span class="skw">wait</span>(<span class="dig">5</span>)
        <span class="skw">click</span>(Pattern(search_path(<span class="str">"big_view_button"</span>)).similar(<span class="dig">0.70</span>))
        <span class="skw">wait</span>(<span class="dig">5</span>)
        <span class="skw">click</span>(Pattern(search_path(<span class="str">"browser_window_button"</span>)).similar(<span class="dig">0.70</span>))
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"show_browser_window"</span>)).similar(<span class="dig">0.90</span>)):
            <span class="kw">print</span>(<span class="str">"browser window opened status"</span>)
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"show_browser_window"</span>)).similar(<span class="dig">0.90</span>))
        <span class="kw">elif</span> exists(Pattern(search_path(<span class="str">"hide_browser_window"</span>)).similar(<span class="dig">0.90</span>)):
            <span class="kw">print</span>(<span class="str">"browser window closed status"</span>)
            <span class="skw">type</span>(Key.ENTER)
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"set browser failed"</span>)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(Key.F5)
        <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="kw">elif</span> os_ver == <span class="str">"Win7"</span>:
        <span class="skw">type</span>(<span class="str">"v"</span>, KeyModifier.ALT)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(<span class="str">"r"</span>, KeyModifier.SHIFT)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="skw">type</span>(Key.ENTER)
        <span class="skw">wait</span>(<span class="dig">2</span>)
        <span class="skw">click</span>(Pattern(search_path(<span class="str">"manager_button"</span>)).similar(<span class="dig">0.70</span>))
        <span class="skw">wait</span>(<span class="dig">3</span>)
        <span class="skw">click</span>(Pattern(search_path(<span class="str">"configuration_button"</span>)).similar(<span class="dig">0.70</span>))
        <span class="skw">wait</span>(<span class="dig">3</span>)
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"show_browser_window_7"</span>)).similar(<span class="dig">0.90</span>)):
            <span class="kw">print</span>(<span class="str">"browser window opened status"</span>)
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"show_browser_window_7"</span>)).similar(<span class="dig">0.90</span>))
        <span class="kw">elif</span> exists(Pattern(search_path(<span class="str">"hide_browser_window_7"</span>)).similar(<span class="dig">0.90</span>)):
            <span class="kw">print</span>(<span class="str">"browser window closed status"</span>)
            <span class="skw">type</span>(Key.ENTER)
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"set browser failed"</span>)
        <span class="skw">wait</span>(<span class="dig">1</span>)
        <span class="skw">type</span>(Key.F5)
        <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Failed"</span>)

<span class="kw">def</span> check_open_folder(os_ver):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="kw">print</span>(<span class="str">"***Start to check_open_folder***"</span>)
    <span class="kw">if</span> os_ver == <span class="str">"Win10"</span>:
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"refresh_button"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"refresh_button"</span>)).similar(<span class="dig">0.70</span>))
            flag = <span class="dig">1</span>
        <span class="kw">else</span>:
            flag = <span class="dig">0</span>
    <span class="kw">else</span>:
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"refresh_button_7"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"refresh_button_7"</span>)).similar(<span class="dig">0.70</span>))
            flag = <span class="dig">1</span>
        <span class="kw">else</span>:
            flag = <span class="dig">0</span>
    <span class="kw">return</span> flag

<span class="kw">def</span> check_max_window(os_ver):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> range(<span class="dig">3</span>):
        <span class="kw">if</span> os_ver == <span class="str">"Win10"</span>:
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"refresh_button"</span>)).similar(<span class="dig">0.70</span>))
        <span class="kw">else</span>:
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"refresh_button_7"</span>)).similar(<span class="dig">0.70</span>))
        <span class="skw">type</span>(Key.UP, KeyModifier.WIN)
        <span class="skw">wait</span>(<span class="dig">3</span>)
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"maxwindow_folder_icon"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="kw">print</span>(<span class="str">"Max window"</span>)
            flag = <span class="dig">1</span>
            <span class="kw">break</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Not max window"</span>)
            flag = <span class="dig">0</span>
    <span class="kw">return</span> flag

<span class="kw">def</span> hover_trayicon():
    flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> range(<span class="dig">10</span>):
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"check_trayicon"</span>)).similar(<span class="dig">0.90</span>)):
            hover(Pattern(search_path(<span class="str">"check_trayicon"</span>)).similar(<span class="dig">0.90</span>))
            <span class="kw">print</span>(<span class="str">"Find check tray icon"</span>)
            flag = <span class="dig">1</span>
        <span class="kw">elif</span> exists(Pattern(search_path(<span class="str">"spinning_trayicon"</span>)).similar(<span class="dig">0.90</span>)):
            hover(Pattern(search_path(<span class="str">"spinning_trayicon"</span>)).similar(<span class="dig">0.90</span>))
            <span class="kw">print</span>(<span class="str">"Find spinning tray icon"</span>)
            flag = <span class="dig">1</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"not find tray icon"</span>)
            flag = <span class="dig">0</span>
            <span class="kw">break</span>

    <span class="kw">return</span> flag

<span class="kw">def</span> clean_trayicon():
    <span class="kw">if</span> hover_trayicon() == <span class="dig">1</span>:
        <span class="kw">pass</span>
    <span class="kw">else</span>:
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"extend_trayicon"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"extend_trayicon"</span>)).similar(<span class="dig">0.70</span>))
            <span class="skw">wait</span>(<span class="dig">5</span>)
            hover_trayicon()
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"not find extend tray icon"</span>)


<span class="cmt">################# Qsync opration function ###################</span>
<span class="kw">def</span> open_qsync(os_bit):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> range(<span class="dig">3</span>):
        <span class="kw">if</span> os_bit == <span class="str">"64"</span>:
            qsync = <span class="str">"C:\Program Files (x86)\QNAP\Qsync\Qsync.exe"</span>
        <span class="kw">else</span>:
            qsync = <span class="str">"C:\Program Files\QNAP\Qsync\Qsync.exe"</span>
        openApp(qsync)
        <span class="skw">wait</span>(<span class="dig">5</span>)
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"delete_button"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"delete_button"</span>)).similar(<span class="dig">0.70</span>))
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"No warning"</span>)
        <span class="kw">if</span> os_bit == <span class="str">"64"</span>:
            os.system(<span class="str">'"C:\\Program Files (x86)\\QNAP\\Qsync\\Qsync.exe"'</span>)
        <span class="kw">else</span>:
            os.system(<span class="str">'"C:\\Program Files\\QNAP\\Qsync\\Qsync.exe"'</span>)
        <span class="skw">wait</span>(<span class="dig">5</span>)
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"minwindow_icon"</span>)).similar(<span class="dig">0.80</span>)):
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"minwindow_icon"</span>)).similar(<span class="dig">0.80</span>))
        <span class="kw">elif</span> exists(Pattern(search_path(<span class="str">"maxwindow_icon"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="kw">print</span>(<span class="str">"Max Qsync window"</span>)
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Max Qsync window failed"</span>)
        <span class="skw">wait</span>(<span class="dig">5</span>)
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"qsync_logo"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="kw">print</span>(<span class="str">"Open Qsync success"</span>)
            flag = <span class="dig">1</span>
            <span class="kw">break</span>
        <span class="kw">else</span>:
            flag = <span class="dig">0</span>
    <span class="kw">assert</span> flag == <span class="dig">1</span>, <span class="str">"Open Qsync failed"</span>

<span class="kw">def</span> close_qsync():
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    os.system(<span class="str">"taskkill /f /im Qsync.exe"</span>)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="kw">if</span> check_qsync_live() == False:
        flag = <span class="dig">1</span>
        <span class="kw">print</span>(<span class="str">"Close Qsync success"</span>)
    <span class="kw">else</span>:
        flag = <span class="dig">0</span>
    <span class="kw">assert</span> flag == <span class="dig">1</span>, <span class="str">"Close Qsync failed"</span>
    <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"qsync_logo"</span>)).similar(<span class="dig">0.70</span>)):
        <span class="kw">print</span>(<span class="str">"Close Qsync fail_UI"</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Close Qsync success_UI"</span>)

<span class="kw">def</span> remove_nas_profile():
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="skw">click</span>(Pattern(search_path(<span class="str">"more_button"</span>)).similar(<span class="dig">0.70</span>))
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="skw">click</span>(Pattern(search_path(<span class="str">"removeNAS_option"</span>)).similar(<span class="dig">0.70</span>))
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="skw">click</span>(Pattern(search_path(<span class="str">"option_button"</span>)).similar(<span class="dig">0.70</span>))
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.DOWN)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<span class="dig">5</span>)
    waitVanish((Pattern(search_path(<span class="str">"pleasewait_string"</span>)).similar(<span class="dig">0.70</span>)),<span class="dig">600</span>)
    <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"host_field"</span>)).similar(<span class="dig">0.70</span>)):
        <span class="kw">print</span>(<span class="str">"Remove NAS success"</span>)
        flag = <span class="dig">1</span>
    <span class="kw">else</span>:
        flag = <span class="dig">0</span>
    <span class="kw">assert</span> flag == <span class="dig">1</span>, <span class="str">"Remove NAS failed"</span>

<span class="kw">def</span> login_pair(ip, ac, pwd):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="skw">click</span>(Pattern(search_path(<span class="str">"host_field"</span>)).similar(<span class="dig">0.70</span>))
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(ip)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(ac)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.TAB)
    <span class="skw">type</span>(pwd)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    waitVanish((Pattern(search_path(<span class="str">"pairing_string"</span>)).similar(<span class="dig">0.70</span>)),<span class="dig">120</span>)
    <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"pairing_string"</span>)).similar(<span class="dig">0.70</span>)):
        <span class="kw">print</span>(<span class="str">"over 2 mins.."</span>)
    <span class="kw">elif</span> exists(Pattern(search_path(<span class="str">"loginfail_string"</span>)).similar(<span class="dig">0.70</span>)):
        <span class="kw">print</span>(<span class="str">"login failed"</span>)
    <span class="kw">elif</span> exists(Pattern(search_path(<span class="str">"qsyncpath_string"</span>)).similar(<span class="dig">0.70</span>)):
        <span class="kw">print</span>(<span class="str">"login success"</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"unknown status"</span>)
    <span class="skw">wait</span>(<span class="dig">5</span>)
    <span class="skw">click</span>(Pattern(search_path(<span class="str">"addfolder_icon"</span>)).similar(<span class="dig">0.70</span>))
    <span class="skw">wait</span>(<span class="dig">2</span>)
    rregion = Region(<span class="dig">447</span>,<span class="dig">151</span>,<span class="dig">387</span>,<span class="dig">368</span>)
    <span class="kw">if</span> rregion.exists(Pattern(search_path(<span class="str">"browsefolder_string"</span>)).similar(<span class="dig">0.70</span>)):
        <span class="kw">print</span>(<span class="str">"open"</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"open Failed"</span>)
    <span class="skw">type</span>(<span class="str">"M"</span>)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(<span class="str">"@Qsync_test"</span>)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<span class="dig">3</span>)
    <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"folder_exist_icon"</span>)).similar(<span class="dig">0.70</span>)):
        <span class="skw">type</span>(Key.ENTER)
        <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="kw">else</span>:
        <span class="kw">pass</span>
    <span class="skw">type</span>(Key.ENTER)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">click</span>(Pattern(search_path(<span class="str">"finish_button"</span>)).similar(<span class="dig">0.70</span>))

<span class="kw">def</span> check_qsync_live():
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    cmd = <span class="str">'TASKLIST /FI "imagename eq Qsync.exe" /svc'</span>
    tasklist_cmd = os.popen(cmd).read()
    <span class="kw">if</span> <span class="str">"Qsync"</span> <span class="kw">in</span> tasklist_cmd:
        <span class="kw">return</span> True
    <span class="kw">else</span>:
        <span class="kw">return</span> False

<span class="kw">def</span> close_qsync_UI():
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="skw">wait</span>(<span class="dig">1</span>)
    <span class="skw">click</span>(Pattern(search_path(<span class="str">"close_button"</span>)).similar(<span class="dig">0.70</span>))
    <span class="skw">wait</span>(<span class="dig">2</span>)
    <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"qsync_logo"</span>)).similar(<span class="dig">0.70</span>)):
        flag = <span class="dig">0</span>
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Close Qsync UI success"</span>)
        flag = <span class="dig">1</span>
    <span class="kw">assert</span> flag == <span class="dig">1</span>, <span class="str">"Close Qsync UI fail"</span>
    <span class="skw">wait</span>(<span class="dig">1</span>)

<span class="cmt">################# Data sync function ###################</span>
<span class="cmt"># input path then get check list (get_check_icon_list(path = "D:\\test"))</span>
<span class="kw">def</span> get_check_icon_list(path, os_ver):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    path = path
    path_q = path + <span class="str">"\\.qsync"</span>
    attrib_cmd = <span class="str">"attrib -s -h -r "</span> + path + <span class="str">"\\*.* &amp;&amp; del "</span> + path + <span class="str">"\\*.* /q"</span>
    dir_cmd = <span class="str">"dir "</span> + path + <span class="str">" /ad /b /s &gt;del.txt"</span>
    <span class="kw">if</span> os_ver == <span class="str">"Win10"</span>:
        to_utf8 = <span class="str">'PowerShell -Command "&amp; {get-content del.txt -encoding default | set-content del_utf8.txt -encoding utf8}"'</span>
    <span class="kw">elif</span> os_ver == <span class="str">"Win7"</span>:
        to_utf8 = <span class="str">'PowerShell -Command "&amp; {get-content del.txt -encoding String | set-content del_utf8.txt -encoding utf8}"'</span>
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Unknown OS"</span>)
    os.system(attrib_cmd)
    os.system(dir_cmd)
    <span class="kw">print</span>(to_utf8)
    <span class="skw">wait</span>(<span class="dig">10</span>)
    os.system(to_utf8)
    <span class="cmt"># add mark to list</span>
    <span class="kw">with</span> open(<span class="str">'del_utf8.txt'</span>, <span class="str">'r'</span>) <span class="kw">as</span> f:
        path_list = f.read()
        path_list = path_list[<span class="dig">3</span>:]
        path_list_space = path_list.split(<span class="str">"\n"</span>)
        switch_list = []
        <span class="kw">for</span> i <span class="kw">in</span> path_list_space:
            <span class="kw">if</span> i == path_q:
                <span class="kw">pass</span>
            <span class="kw">else</span>:
                mark_string = <span class="str">'\"'</span> + i + <span class="str">'\"'</span>
                switch_list.append(mark_string)
    <span class="kw">del</span> switch_list[-<span class="dig">1</span>]
    <span class="kw">print</span>(len(switch_list))
    <span class="cmt"># get mark txt file</span>
    <span class="kw">with</span> open(<span class="str">'del_utf8.txt'</span>, <span class="str">'w'</span>) <span class="kw">as</span> e:
        <span class="kw">for</span> j <span class="kw">in</span> switch_list:
            e.write(j)
            e.write(<span class="str">'\n'</span>)
    <span class="cmt"># get final list</span>
    <span class="kw">with</span> open(<span class="str">'del_utf8.txt'</span>, <span class="str">'r'</span>) <span class="kw">as</span> g:
        mark_data = g.read()
        mark_list = mark_data.split(<span class="str">"\n"</span>)
        <span class="kw">del</span> mark_list[-<span class="dig">1</span>]
    <span class="kw">return</span> mark_list

<span class="kw">def</span> check_icon_no(data_items, row_items):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="str">"""
    data_items = 110
    row_items = 11
    """</span>
    <span class="cmt"># get items at first page</span>
    <span class="kw">try</span>:
        a = findAll(Pattern(search_path(<span class="str">"syncdone_item_icon"</span>)).similar(<span class="dig">0.70</span>))
        b = []
        <span class="kw">for</span> i <span class="kw">in</span> a:
            b.append(i)
        <span class="kw">print</span>(<span class="str">"First page catch:"</span> + str(len(b)))
    <span class="kw">except</span>:
        b = []
    page_item_no = len(b)
    d = []
    <span class="kw">if</span> page_item_no == <span class="dig">0</span>:
        <span class="kw">print</span>(<span class="str">"number: "</span> + str(len(b)))
    <span class="kw">elif</span> data_items &lt;= page_item_no:
        <span class="kw">print</span>(<span class="str">"number: "</span> + str(len(b)))
    <span class="kw">else</span>:
        click_region = Region(<span class="dig">1194</span>,<span class="dig">583</span>,<span class="dig">86</span>,<span class="dig">137</span>)
        <span class="kw">for</span> i <span class="kw">in</span> range(<span class="dig">5</span>):
            <span class="kw">if</span> click_region.exists(Pattern(search_path(<span class="str">"down_button"</span>)).similar(<span class="dig">0.70</span>)):
                click_region.<span class="skw">click</span>(Pattern(search_path(<span class="str">"down_button"</span>)).similar(<span class="dig">0.70</span>))
                <span class="skw">wait</span>(<span class="dig">1</span>)
                xregion = Region(<span class="dig">13</span>,<span class="dig">562</span>,<span class="dig">1239</span>,<span class="dig">84</span>)
                c = xregion.findAll(Pattern(search_path(<span class="str">"syncdone_item_icon"</span>)).similar(<span class="dig">0.70</span>))
                <span class="kw">for</span> j <span class="kw">in</span> c:
                    d.append(j)
                <span class="kw">print</span>(len(d))
                <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"down_end_button"</span>)).similar(<span class="dig">0.70</span>)):
                    <span class="kw">print</span>(<span class="str">"move to end"</span>)
                    <span class="kw">break</span>
                <span class="kw">else</span>:
                    <span class="kw">pass</span>
            <span class="kw">else</span>:
                <span class="kw">print</span>(<span class="str">"number: "</span> + str(len(b)))
                <span class="kw">break</span>
    ss = len(b) + len(d)
    <span class="kw">if</span> len(b) &gt; data_items:
        <span class="kw">print</span>(ss)
    <span class="kw">elif</span> ss &gt; data_items:
        ss = ss -row_items
        <span class="kw">print</span>(ss)
    <span class="kw">else</span>:
        <span class="kw">print</span>(ss)
    <span class="kw">return</span> ss

<span class="cmt"># counter_data</span>
<span class="cmt"># counter_type = file or folder; result_line = dir_result_line</span>
<span class="kw">def</span> output_counter_list(out_type, result_line):
    <span class="kw">if</span> out_type == <span class="str">"folder"</span>:
        data_space = result_line[-<span class="dig">2</span>].split(<span class="str">" "</span>)
    <span class="kw">elif</span> out_type == <span class="str">"file"</span>:
        data_space = result_line[-<span class="dig">3</span>].split(<span class="str">" "</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"gg"</span>)
    no_list = []
    <span class="kw">for</span> i <span class="kw">in</span> data_space:
        <span class="kw">if</span> i != <span class="str">""</span>:
            no_list.append(i)
    <span class="kw">return</span> no_list

<span class="cmt"># data_type = file, folder, size, total(file+folde),icon_total(file+folder-2), counter_type = single or all</span>
<span class="cmt"># icon_total + single = icon check no</span>
<span class="cmt"># current_data_counter</span>
<span class="kw">def</span> counter_data(data_type, counter_type, path):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="kw">if</span> counter_type == <span class="str">"single"</span>:
        dir_cmd = <span class="str">"dir "</span> + path
    <span class="kw">elif</span> counter_type == <span class="str">"all"</span>:
        dir_cmd = <span class="str">"dir "</span> + path + <span class="str">" /s"</span>
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Unknown counter_type"</span>)
    dir_result = os.popen(dir_cmd).read()
    <span class="cmt"># print(dir_result)</span>
    dir_result_line = dir_result.split(<span class="str">"\n"</span>)
    <span class="kw">if</span> data_type == <span class="str">"file"</span>:
        <span class="kw">try</span>:
            file_no = int(output_counter_list(<span class="str">"file"</span>, dir_result_line)[<span class="dig">0</span>])
        <span class="kw">except</span>:
            file_no = -<span class="dig">1</span>
        <span class="kw">return</span> file_no
    <span class="kw">elif</span> data_type == <span class="str">"folder"</span>:
        <span class="kw">try</span>:
            folder_no = int(output_counter_list(<span class="str">"folder"</span>, dir_result_line)[<span class="dig">0</span>])
        <span class="kw">except</span>:
            folder_no = -<span class="dig">1</span>
        <span class="kw">return</span> folder_no
    <span class="kw">elif</span> data_type == <span class="str">"size"</span>:
        <span class="kw">try</span>:
            file_size = output_counter_list(<span class="str">"file"</span>, dir_result_line)[<span class="dig">2</span>]
            file_size_f = size_to_int(file_size)
        <span class="kw">except</span>:
            file_size_f = -<span class="dig">1</span>
        <span class="kw">return</span> file_size_f
    <span class="kw">elif</span> data_type == <span class="str">"total"</span>:
        <span class="kw">try</span>:
            file_no = int(output_counter_list(<span class="str">"file"</span>, dir_result_line)[<span class="dig">0</span>])
            folder_no = int(output_counter_list(<span class="str">"folder"</span>, dir_result_line)[<span class="dig">0</span>])
            total = folder_no + file_no
        <span class="kw">except</span>:
            total = -<span class="dig">1</span>
        <span class="kw">return</span> total
    <span class="kw">elif</span> data_type == <span class="str">"icon_total"</span>:
        <span class="kw">try</span>:
            file_no = int(output_counter_list(<span class="str">"file"</span>, dir_result_line)[<span class="dig">0</span>])
            folder_no = int(output_counter_list(<span class="str">"folder"</span>, dir_result_line)[<span class="dig">0</span>])
            icon_total = folder_no + file_no -<span class="dig">2</span>
        <span class="kw">except</span>:
            icon_total = -<span class="dig">1</span>
        <span class="kw">return</span> icon_total
    <span class="kw">else</span>:
        <span class="kw">return</span> <span class="dig">0</span>

<span class="kw">def</span> counter_surplus_no(data_type, counter_type, path):
    <span class="kw">try</span>:
        surplus_no = counter_data(data_type, counter_type, path)
        <span class="kw">if</span> surplus_no == -<span class="dig">1</span>:
            surplus_no = <span class="dig">0</span>
        <span class="kw">else</span>:
            surplus_no = surplus_no
    <span class="kw">except</span>:
        surplus_no = <span class="dig">0</span>
    <span class="kw">return</span> surplus_no

<span class="kw">def</span> size_to_int(size):
    size = size.replace(<span class="str">','</span>, <span class="str">''</span>)
    <span class="kw">return</span> int(size)

<span class="kw">def</span> check_data_result(path1, path2):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    right_week = target_week()
    <span class="kw">if</span> path1 == <span class="str">"fixed_path_share"</span>:
        path_from_total = right_week[<span class="str">"share_file"</span>] + right_week[<span class="str">"share_folder"</span>]
        path_from_size = right_week[<span class="str">"share_size"</span>]
    <span class="kw">elif</span> path1 == <span class="str">"fixed_path_team"</span>:
        path_from_total = right_week[<span class="str">"team_file"</span>] + right_week[<span class="str">"team_folder"</span>]
        path_from_size = right_week[<span class="str">"team_size"</span>]
    <span class="kw">else</span>:
        path_surplus = path1 + <span class="str">"\\.qsync"</span>
        path_from_total = counter_data(<span class="str">"total"</span>, <span class="str">"all"</span>, path1) - counter_surplus_no(<span class="str">"total"</span>, <span class="str">"all"</span>, path_surplus)
        path_from_size = counter_data(<span class="str">"size"</span>, <span class="str">"all"</span>, path1)- counter_surplus_no(<span class="str">"size"</span>, <span class="str">"all"</span>, path_surplus)
    <span class="kw">print</span>(<span class="str">"Source total = "</span> + str(path_from_total))
    <span class="kw">print</span>(<span class="str">"Source size = "</span> + str(path_from_size))

    path_surplus = path2 + <span class="str">"\\.qsync"</span>
    path_to_total = counter_data(<span class="str">"total"</span>, <span class="str">"all"</span>, path2) - counter_surplus_no(<span class="str">"total"</span>, <span class="str">"all"</span>, path_surplus)
    <span class="kw">print</span>(<span class="str">"Destination total = "</span> + str(path_to_total))
    path_to_size = counter_data(<span class="str">"size"</span>, <span class="str">"all"</span>, path2) - counter_surplus_no(<span class="str">"size"</span>, <span class="str">"all"</span>, path_surplus)
    <span class="kw">print</span>(<span class="str">"Destination size = "</span> + str(path_to_size))

    <span class="kw">if</span> path_from_total == path_to_total <span class="kw">and</span> path_from_size == path_to_size:
        <span class="kw">print</span>(<span class="str">"Copy data consistent"</span>)
        <span class="kw">return</span> True
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Copy data inconsistent"</span>)
        <span class="kw">return</span> False

<span class="cmt"># copy_data("D:\\test", "D:\\test2\\", "by_week")</span>
<span class="kw">def</span> copy_data(path1, path2, check_type):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    path_from = path1
    <span class="kw">if</span> check_type == <span class="str">"by_week"</span>:
        path_to = path2 + week_current()
    <span class="kw">else</span>:
        path_to = path2
    dir_cmd = <span class="str">"dir "</span> + path2
    <span class="kw">print</span>(dir_cmd)
    copy_cmd = <span class="str">"XCOPY "</span> + path_from + <span class="str">" "</span> + path_to + <span class="str">"\ /I /E /Y"</span>
    <span class="kw">if</span> os.system(dir_cmd) == <span class="dig">0</span>:
        os.system(copy_cmd)
        <span class="kw">if</span> check_data_result(path1 = path_from, path2 = path_to) == <span class="dig">1</span>:
            <span class="kw">print</span>(<span class="str">"Copy data success"</span>)
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Copy data failed"</span>)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"Folder not existed"</span>)

<span class="kw">def</span> outut_page_items():
    current_icon_list = []
    <span class="kw">try</span>:
        icon_findall = findAll(Pattern(search_path(<span class="str">"syncdone_item_icon"</span>)).similar(<span class="dig">0.70</span>))
        <span class="kw">for</span> i <span class="kw">in</span> icon_findall:
            current_icon_list.append(i)
    <span class="kw">except</span>:
        current_icon_list = []
    <span class="kw">print</span>(<span class="str">"current page icon: "</span> + str(len(current_icon_list)))
    <span class="kw">return</span> len(current_icon_list)

<span class="kw">def</span> output_line_items():
    line_list = []
    <span class="kw">try</span>:
        xregion = Region(<span class="dig">7</span>,<span class="dig">526</span>,<span class="dig">1247</span>,<span class="dig">127</span>)
        icon_findline = xregion.findAll(Pattern(search_path(<span class="str">"syncdone_item_icon"</span>)).similar(<span class="dig">0.70</span>))
        <span class="kw">for</span> j <span class="kw">in</span> icon_findline:
            line_list.append(j)
    <span class="kw">except</span>:
        line_list = []
    <span class="kw">print</span>(<span class="str">"current line icon: "</span> + str(len(line_list)))
    <span class="kw">return</span>(len(line_list))

<span class="kw">def</span> check_icon_result(data_items, row_items, page_item_no):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="kw">if</span> data_items == page_item_no:
        <span class="kw">print</span>(<span class="str">"Icon check PASS: "</span> + str(page_item_no))
        flag = <span class="dig">1</span>
    <span class="kw">elif</span> data_items &lt; page_item_no:
        <span class="kw">print</span>(<span class="str">"Icon check fail"</span>)
        flag = <span class="dig">2</span>
    <span class="kw">else</span>:
        <span class="kw">if</span> page_item_no % row_items == <span class="dig">0</span> <span class="kw">and</span> data_items &gt; row_items * <span class="dig">3</span>:
            flag = <span class="dig">0</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Icon check fail"</span>)
            flag = <span class="dig">3</span>
    <span class="kw">return</span> flag

<span class="kw">def</span> down_icon_check(data_items, row_items ,page_item_no):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    quotient = data_items / row_items
    remainder = data_items % row_items
    exclude_no = page_item_no / row_items
    <span class="kw">if</span> remainder == <span class="dig">0</span>:
        down_time = quotient - exclude_no + <span class="dig">1</span>
    <span class="kw">else</span>:
        down_time = quotient - exclude_no + <span class="dig">2</span>
    <span class="kw">print</span>(<span class="str">"Max down times is: "</span> + str(down_time))
    result_icon = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> range(down_time):
        <span class="cmt"># click_region = Region(1253,625,27,36)</span>
        <span class="kw">try</span>:
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"down_button"</span>)).similar(<span class="dig">0.70</span>))
        <span class="kw">except</span>:
            <span class="kw">print</span>(<span class="str">"Press down button fail"</span>)
        add_item_no = output_line_items()
        result_icon = result_icon + add_item_no
        <span class="kw">if</span> add_item_no != row_items:
            <span class="kw">break</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(result_icon)
    total_no = page_item_no + result_icon
    <span class="kw">if</span> total_no &gt; data_items:
        total_final = total_no -<span class="dig">11</span>
    <span class="kw">else</span>:
        total_final = total_no
    <span class="kw">print</span>(<span class="str">"first"</span> + str(page_item_no))
    <span class="kw">print</span>(<span class="str">"add items: "</span> + str(result_icon))
    <span class="kw">print</span>(<span class="str">"Total number: "</span> + str(total_no))
    <span class="kw">print</span>(<span class="str">"Final total number: "</span> + str(total_final))
    <span class="kw">return</span> total_final

<span class="kw">def</span> check_icon_no_N(data_items, row_items):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="cmt"># get items at first page</span>
    x = <span class="dig">0</span>
    flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> range(<span class="dig">2</span>):
        <span class="kw">if</span> x == <span class="dig">0</span>:
            first_page_item_no = outut_page_items()
            page_item_no = first_page_item_no
            <span class="kw">print</span>(<span class="str">"First page icon no= "</span> + str(first_page_item_no))
        <span class="kw">else</span>:
            page_item_no = down_icon_check(data_items, row_items, first_page_item_no)
        icon_result = check_icon_result(data_items, row_items , page_item_no)
        <span class="kw">if</span> icon_result == <span class="dig">1</span>:
            <span class="kw">print</span>(<span class="str">"End icon check: Result PASS"</span>)
            flag = <span class="dig">1</span>
            <span class="kw">break</span>
        <span class="kw">elif</span> icon_result == <span class="dig">0</span>:
            <span class="kw">print</span>(<span class="str">"Enter advanced check step"</span>)
            flag = <span class="dig">0</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"End icon check: Result FAIL"</span>)
            flag = <span class="dig">0</span>
            <span class="kw">break</span>
        x = x + <span class="dig">1</span>
    <span class="kw">return</span> flag

<span class="kw">def</span> check_sync_icon(path, os_ver, os_bit):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="kw">print</span>(path)
    <span class="kw">if</span> counter_data(<span class="str">"icon_total"</span>, <span class="str">"single"</span>, path) != -<span class="dig">1</span>:
        open_folder_cmd(path, os_ver)
        set_browser_sty(os_ver)
        data_items = counter_data(<span class="str">"icon_total"</span>, <span class="str">"single"</span>, path)
        <span class="kw">print</span>(<span class="str">"Check items = "</span> + str(data_items))
        <span class="kw">if</span> os_bit == <span class="str">"64"</span>:
            row_items = <span class="dig">11</span>
        <span class="kw">else</span>:
            row_items = <span class="dig">17</span>
        <span class="kw">if</span> check_icon_no_N(data_items, row_items) == <span class="dig">1</span>:
            <span class="kw">print</span>(<span class="str">"pass icon check"</span>)
            flag = <span class="dig">1</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"fail icon check"</span>)
            flag = <span class="dig">0</span>
        <span class="kw">if</span> os_ver == <span class="str">"Win10"</span>:
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"refresh_button"</span>)).similar(<span class="dig">0.70</span>))
        <span class="kw">else</span>:
            <span class="skw">click</span>(Pattern(search_path(<span class="str">"refresh_button_7"</span>)).similar(<span class="dig">0.70</span>))
        <span class="skw">type</span>(Key.F4, KeyModifier.ALT)
    <span class="kw">else</span>:
        <span class="kw">print</span>(<span class="str">"pass icon check, no folder"</span>)
        flag = <span class="dig">1</span>
    <span class="kw">return</span> flag

<span class="kw">def</span> random_icon_check(ran_switch, ran_no, os_ver, os_bit, *args):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    <span class="kw">if</span> isinstance(args[<span class="dig">0</span>], list) == True:
        args = args[<span class="dig">0</span>]
    <span class="kw">else</span>:
        args = args
    <span class="cmt"># decide run_list</span>
    <span class="kw">if</span> ran_switch == <span class="str">"Y"</span>:
        <span class="kw">if</span> len(args) == <span class="dig">1</span>:
            run_list = random.sample(args, <span class="dig">1</span>)
        <span class="kw">else</span>:
            run_list = random.sample(args, ran_no)
    <span class="kw">else</span>:
        run_list = args
        ran_no = <span class="dig">1</span>
    result_flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> run_list:
        <span class="kw">print</span>(i)
        flag = check_sync_icon(i, os_ver, os_bit)
        <span class="kw">if</span> flag != <span class="dig">1</span>:
            result_flag = <span class="dig">0</span>
            <span class="kw">break</span>
        <span class="kw">else</span>:
            result_flag = <span class="dig">1</span>
    <span class="kw">return</span> result_flag

<span class="kw">def</span> check_team_folder(os_ver, os_bit):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    week_info = week_current()
    qa = get_pc_info(<span class="str">"pc_name"</span>)
    check_flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> AT_list:
        ew = i[<span class="str">"folder_name"</span>].split(<span class="str">"_"</span>)
        <span class="kw">if</span> week_info == <span class="str">"Sat"</span> <span class="kw">or</span> week_info == <span class="str">"Sun"</span>:
            path = <span class="str">"C:\\Users\\"</span> + get_pc_info(<span class="str">"user_name"</span>) + <span class="str">"\\Qsync\\"</span> + i[<span class="str">"folder_name"</span>]
        <span class="kw">else</span>:
            path = <span class="str">"C:\\Users\\"</span> + get_pc_info(<span class="str">"user_name"</span>) + <span class="str">"\\Qsync\\"</span> + i[<span class="str">"folder_name"</span>] + <span class="str">"\\"</span> + week_info
        <span class="kw">if</span> ew[-<span class="dig">1</span>] == qa:
            <span class="kw">pass</span>
        <span class="kw">else</span>:
            <span class="cmt"># mount_disk(i["ip"],i["folder_name"],i["ac"],i["pwd"],"w") </span>
            <span class="kw">if</span> check_data_result(<span class="str">"fixed_path_team"</span>, path) == True:
                <span class="kw">print</span>(<span class="str">"Data files, folders and size match"</span>)
                check_flag = <span class="dig">1</span>
            <span class="kw">else</span>:
                <span class="kw">print</span>(<span class="str">"Data files, folders and size not match"</span>)
                check_flag = <span class="dig">0</span>
                <span class="kw">break</span>
            <span class="kw">if</span> check_sync_icon(path = path, os_ver = os_ver, os_bit = os_bit) == <span class="dig">1</span>:
                <span class="kw">print</span>(<span class="str">"Root folder icon check PASS"</span>)
                check_flag = <span class="dig">1</span>
            <span class="kw">else</span>:
                <span class="kw">print</span>(<span class="str">"Root folder icon check FAIL"</span>)
                check_flag = <span class="dig">0</span>
            adv_flag = counter_data(<span class="str">"icon_total"</span>, <span class="str">"single"</span>, path)
            <span class="kw">if</span> adv_flag == <span class="dig">0</span>:
                <span class="kw">print</span>(<span class="str">"Pass advanced icon check"</span>)
            <span class="kw">elif</span> adv_flag == -<span class="dig">1</span>:
                <span class="kw">print</span>(<span class="str">"Pass advanced icon check, no folder"</span>)
            <span class="kw">else</span>:
                mark_list = get_check_icon_list(path, os_ver)
                <span class="kw">if</span> random_icon_check(<span class="str">"Y"</span>, <span class="dig">2</span>, os_ver, os_bit, mark_list) == <span class="dig">1</span>:
                    <span class="kw">print</span>(<span class="str">"Advanced folder icon check PASS"</span>)
                    check_flag = <span class="dig">1</span>
                <span class="kw">else</span>:
                    <span class="kw">print</span>(<span class="str">"Advanced folder icon check FAIL"</span>)
                    check_flag = <span class="dig">0</span>
                    <span class="kw">break</span>
            <span class="cmt"># unmount_disk("w")</span>
    <span class="kw">return</span> check_flag

<span class="kw">def</span> check_share_folder(os_ver, os_bit):
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    i = AT_PC_S1
    week_info = week_current()
    check_flag = <span class="dig">0</span>
    <span class="kw">for</span> j <span class="kw">in</span> range(<span class="dig">1</span>):
        <span class="kw">if</span> week_info == <span class="str">"Sat"</span> <span class="kw">or</span> week_info == <span class="str">"Sun"</span>:
            path = <span class="str">"C:\\Users\\"</span> + get_pc_info(<span class="str">"user_name"</span>) + <span class="str">"\\@Qsync_test\\"</span>
        <span class="kw">else</span>:
            path = <span class="str">"C:\\Users\\"</span> + get_pc_info(<span class="str">"user_name"</span>) + <span class="str">"\\@Qsync_test\\"</span> + week_info
        <span class="kw">print</span>(path)
        <span class="cmt"># mount_disk(i["ip"],"@Qsync_test",i["ac"],i["pwd"],"w") </span>
        <span class="kw">if</span> check_data_result(<span class="str">"fixed_path_share"</span>, path) == True:
            <span class="kw">print</span>(<span class="str">"Data files, folders and size match"</span>)
            check_flag = <span class="dig">1</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Data files, folders and size not match"</span>)
            check_flag = <span class="dig">2</span>
            <span class="kw">break</span>
        <span class="kw">if</span> check_sync_icon(path = path, os_ver = os_ver, os_bit = os_bit) == <span class="dig">1</span>:
            <span class="kw">print</span>(<span class="str">"Root folder icon check PASS"</span>)
            check_flag = <span class="dig">1</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Root folder icon check FAIL"</span>)
            check_flag = <span class="dig">3</span>
            <span class="kw">break</span>
        adv_flag = counter_data(<span class="str">"icon_total"</span>, <span class="str">"single"</span>, path)
        <span class="kw">if</span> adv_flag == <span class="dig">0</span>:
            <span class="kw">print</span>(<span class="str">"Skip advanced icon check"</span>)
        <span class="kw">elif</span> adv_flag == -<span class="dig">1</span>:
            <span class="kw">print</span>(<span class="str">"Skip advanced icon check, no folder"</span>)
        <span class="kw">else</span>:
            mark_list = get_check_icon_list(path, os_ver)
            <span class="kw">if</span> random_icon_check(<span class="str">"Y"</span>, <span class="dig">2</span>, os_ver, os_bit, mark_list) == <span class="dig">1</span>:
                <span class="kw">print</span>(<span class="str">"Advanced folder icon check PASS"</span>)
                check_flag = <span class="dig">1</span>
            <span class="kw">else</span>:
                <span class="kw">print</span>(<span class="str">"Advanced folder icon check FAIL"</span>)
                check_flag = <span class="dig">4</span>
                <span class="kw">break</span>
        <span class="cmt"># unmount_disk("w")</span>
    <span class="kw">return</span> check_flag

<span class="kw">def</span> check_main_sync():
    fun_name = sys._getframe().f_code.co_name
    <span class="kw">print</span>(<span class="str">"***Start to "</span> + fun_name + <span class="str">" ***"</span>)
    flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> range(<span class="dig">10</span>):
        <span class="skw">wait</span>(<span class="dig">4</span>)
        <span class="kw">if</span> exists(Pattern(search_path(<span class="str">"syncdone_icon"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="kw">print</span>(<span class="str">"Sync success, start to check data"</span>)
            flag = <span class="dig">1</span>
        <span class="kw">elif</span> exists(Pattern(search_path(<span class="str">"syncing_icon"</span>)).similar(<span class="dig">0.70</span>)):
            <span class="kw">print</span>(<span class="str">"Syncing..."</span>)
            flag = <span class="dig">2</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Sync failed"</span>)
            flag = <span class="dig">0</span>
    <span class="kw">return</span> flag

<span class="kw">def</span> target_client():
    current_pc = get_pc_info(<span class="str">"pc_name"</span>)
    <span class="kw">print</span>(current_pc)
    <span class="kw">for</span> i <span class="kw">in</span> AT_list:
        <span class="kw">if</span> i[<span class="str">"pc_name"</span>] == current_pc:
            target_client = i
            <span class="kw">break</span>
        <span class="kw">else</span>:
            target_client = <span class="str">"unknown"</span>
    <span class="kw">return</span> target_client

<span class="kw">def</span> copy_file(from_path, to_path, file):
    path_done = to_path + file
    copy_cmd = <span class="str">"COPY "</span> + from_path + <span class="str">" "</span> + to_path + <span class="str">" /Y"</span>
    <span class="kw">print</span>(copy_cmd)
    <span class="kw">if</span> exist_check(to_path) == <span class="str">"True"</span> <span class="kw">and</span> exist_check(from_path) == <span class="str">"True"</span>:
        exist_flag = <span class="dig">1</span>
        os.system(copy_cmd)
        <span class="kw">if</span> exist_check(path_done) == <span class="str">"True"</span>:
            flag = <span class="dig">1</span>
            <span class="kw">print</span>(<span class="str">"Copy data success"</span>)
        <span class="kw">else</span>:
            flag = <span class="dig">0</span>
        <span class="kw">assert</span> flag == <span class="dig">1</span>, <span class="str">"Copy data failed"</span>
    <span class="kw">else</span>:
        exist_flag = <span class="dig">0</span>
        <span class="kw">print</span>(<span class="str">"Folder not existed"</span>)
    <span class="kw">assert</span> exist_flag == <span class="dig">1</span>, <span class="str">"Source or destination not exist"</span>

<span class="kw">def</span> output_checksum_list(data_path):
    cmd = <span class="str">"C:\\fciv\\fciv.exe -r "</span> + data_path
    che_cmd = os.popen(cmd).read()
    output_line = che_cmd.split(<span class="str">"\n"</span>)
    che_list = []
    start_flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> output_line:
        <span class="cmt"># print(i,a.index(i))</span>
        <span class="kw">if</span> <span class="str">"Start Time"</span> <span class="kw">in</span> i:
            add_flag = output_line.index(i)
            start_flag = <span class="dig">1</span>
            <span class="kw">print</span>(<span class="str">"start_flag:"</span> + str(start_flag))
        <span class="kw">elif</span> <span class="str">"End Time"</span> <span class="kw">in</span> i:
            <span class="kw">break</span>
        <span class="kw">elif</span> start_flag == <span class="dig">1</span> <span class="kw">and</span> output_line.index(i) &gt; add_flag:
            <span class="kw">if</span> i != <span class="str">""</span>:
                i = i.split(<span class="str">" "</span>)
                che_list.append(i[<span class="dig">0</span>])
        <span class="kw">else</span>:
            <span class="kw">pass</span>
    <span class="kw">return</span> che_list

<span class="kw">def</span> output_checksum_file(data_path):
    check_list = output_checksum_list(data_path)
    week_info = week_current()
    checksum_file = <span class="str">"checksum_"</span> + week_info + <span class="str">".txt"</span>
    <span class="kw">with</span> open(checksum_file, <span class="str">'w'</span>) <span class="kw">as</span> e:
        <span class="kw">for</span> j <span class="kw">in</span> check_list:
            e.write(j)
            e.write(<span class="str">'\n'</span>)

<span class="kw">def</span> output_checksum_list_from_file(checksum_path):
    week_info = week_current()
    file = <span class="str">"checksum_"</span> + week_info + <span class="str">".txt"</span>
    checksum_file_path = checksum_path + file
    <span class="kw">with</span> open(checksum_file_path, <span class="str">'r'</span>) <span class="kw">as</span> g:
        mark_data = g.read()
        mark_list = mark_data.split(<span class="str">"\n"</span>)
        <span class="kw">del</span> mark_list[-<span class="dig">1</span>]
    <span class="kw">return</span> mark_list

<span class="kw">def</span> check_checksum(checksum_path, data_path):
    source_list = output_checksum_list_from_file(checksum_path)
    compare_list = output_checksum_list(data_path)
    <span class="kw">if</span> source_list == compare_list:
        flag = <span class="dig">1</span>
        <span class="kw">print</span>(<span class="str">"Checksum check PASS"</span>)
    <span class="kw">else</span>:
        flag = <span class="dig">0</span>
        <span class="kw">print</span>(<span class="str">"Checksum check FAIL"</span>)
    <span class="kw">return</span> flag

<span class="kw">def</span> check_checksum_share():
    week_info = week_current()
    <span class="kw">if</span> week_info == <span class="str">"Sat"</span> <span class="kw">or</span> week_info == <span class="str">"Sun"</span>:
        <span class="kw">print</span>(<span class="str">"Skip Checksum_share"</span>)
        check_flag = <span class="dig">1</span>
    <span class="kw">else</span>:
        checksum_path = <span class="str">"C:\\Users\\"</span> + get_pc_info(<span class="str">"user_name"</span>) + <span class="str">"\\@Qsync_test\\"</span>
        <span class="kw">print</span>(checksum_path)
        data_path = checksum_path + week_info
        <span class="kw">print</span>(data_path)
        <span class="kw">if</span> check_checksum(checksum_path, data_path) == <span class="dig">1</span>:
            <span class="kw">print</span>(<span class="str">"Checksum_share match"</span>)
            check_flag = <span class="dig">1</span>
        <span class="kw">else</span>:
            <span class="kw">print</span>(<span class="str">"Checksum_share not match"</span>)
            check_flag = <span class="dig">0</span>
    <span class="kw">return</span> check_flag

<span class="kw">def</span> check_checksum_team():
    week_info = week_current()
    qa = get_pc_info(<span class="str">"pc_name"</span>)
    check_flag = <span class="dig">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> AT_list:
        ew = i[<span class="str">"folder_name"</span>].split(<span class="str">"_"</span>)
        <span class="kw">if</span> week_info == <span class="str">"Sat"</span> <span class="kw">or</span> week_info == <span class="str">"Sun"</span>:
            <span class="kw">print</span>(<span class="str">"Skip Checksum_share: "</span> + i[<span class="str">"folder_name"</span>])
            check_flag = <span class="dig">1</span>
            <span class="kw">break</span>
        <span class="kw">else</span>:
            checksum_path = <span class="str">"C:\\Users\\"</span> + get_pc_info(<span class="str">"user_name"</span>) + <span class="str">"\\Qsync\\"</span> + i[<span class="str">"folder_name"</span>] + <span class="str">"\\"</span>
            data_path = checksum_path + week_info
        <span class="kw">if</span> ew[-<span class="dig">1</span>] == qa:
            <span class="kw">pass</span>
        <span class="kw">else</span>:
            <span class="kw">if</span> check_checksum(checksum_path, data_path) == <span class="dig">1</span>:
                <span class="kw">print</span>(<span class="str">"Checksum_team PASS: "</span> + i[<span class="str">"folder_name"</span>])
                check_flag = <span class="dig">1</span>
            <span class="kw">else</span>:
                <span class="kw">print</span>(<span class="str">"Checksum_team FAIL: "</span> + i[<span class="str">"folder_name"</span>])
                check_flag = <span class="dig">0</span>
                <span class="kw">break</span>
    <span class="kw">return</span> check_flag
</pre>
</body>
</html>
